---
title: Windows 空间管理/清理指南
description: “软件装D盘”是且仅是旧日的经验之谈，如果想让电脑用起来更顺手，“无为而治”或许是个好选择。
date: 2024-07-13 00:29:36
updated: 2024-11-02 16:10:21
image: https://7.isyangs.cn/24/669776aed29f4-24.jpg
categories: [经验分享]
tags: [教程, 系统, Windows, 存储]
url: df78
---

## 软件安装位置

软件应当安装在哪里？来看看山东大学镜像站的 [Windows 安装指南](https://mirrors.sdu.edu.cn/docs/guide/Windows-iso/) 怎么说：

> **有人说系统安装到 C 盘，软件装 D 盘，对吗？**
>
> 不正确，“系统安装到 C 盘，软件装 D 盘”是旧时代的优化策略，具有时代的局限性，**不适用于现在**。具体而言，机械硬盘是由圆形的盘片组成，角速度相同，故线速度外圈大于内圈，造成了不同区域访问速度不一致的情况。划分小容量 C 盘并将软件放到 D 盘，是为了将最快的部分留给操作系统，次快的部分留给应用程序。目前固态硬盘已经普及，这样的优化策略已经失效，不是正确的使用习惯，不应该提倡，更**不应该作为“考试题目”“经验之谈”误导更多的人**。
>
> 一般来说只需要将系统（和软件）划分到 C 盘，用户的文档和各种资料划分到 D 盘即可。**任何操作系统都会为应用程序规划最合理的安装路径**，对于 Windows 来说，即为 Program Files 文件夹，因此在安装软件时，默认路径即为最佳选择。其次，过多的分区不利于管理，无法在分区时精确预测到未来的硬盘使用情况，可能会出现一个分区容量不足，其他分区空闲的情况。再次，应用程序在重装系统后便会由于注册表丢失、公用文件丢失等原因无法全功能工作，因此也没有保留的必要。永远保留软件的安装包，而不是保留安装后的软件目录。最后，将软件目录和用户文件一起存放，也会使得备份重要数据时，无法分清哪些是真正重要的用户资料，哪些则是不重要的软件目录，造成不必要的时间浪费。

**不主动干预**软件的安装路径，可以省去很多麻烦。自定义安装路径带来的风险有三：

- 用户、系统层面安装的软件难分开。像百度网盘、VS Code 这类软件只会为本用户安装，其安装路径在 `C:\Users\username\AppData\Local\` 下；QQ、微信等软件会在系统全局安装，其路径在 `C:\Program Files\` 下。如果把用户层级的软件安装在 D 盘，不符合用户、系统层级的软件区分。
- 目录权限被篡改。例如：将 QQ 安装在 `D:\`，会导致整个硬盘分区的文件权限被修改，从而导致部分软件运行报权限错误、个人文件移动/重命名需要管理员权限。
- 程序文件被覆盖。如果手动修改，可能会遇到“嵌套”问题，例如：指定 QQ 的安装路径为 `D:\Software`，那么 QQ 的文件会平铺在 `Software` 文件夹中，而不是聚合在 `D:\Software\QQ` 里（并非 QQ 安装程序设计问题）；如果安装的软件更多，这种平铺可能会导致程序文件被覆盖，进而影响正常运行。

安卓软件的用户数据远大于软件包体；类似的，Windows 应用程序的用户数据存在 `C:\Users\username\AppData\` 下，其数据也可能远大于程序本体目录，更改程序本体目录可能并不是个好主意。即使抱着“软件装 D 盘，重装系统还在”的思想，其升级、卸载也会遇到困难。

::folding{title="先前关于干预“软件安装位置”的碎碎念"}

- 不要更改软件的默认安装路径。一般来说，软件会安装在 C 盘，这样可以保证软件的正常运行和更新。如果你是“**D 盘原教旨主义者**”，请三思而后行。因为：
  - 重装系统之后，C 盘数据会被清空，D 盘留下的只是软件尸体
  - 此时，不可用的软件会和一部分个人文件混合在一起
  - 如果想直接使用，那么需要逐个检查之前残留的软件，双击打开，在桌面和开始菜单中创建快捷方式
  - 但这样还不够，系统中没有软件正常安装的信息，所以不能卸载它
  - 如果已经在新系统运行过它，那更糟了，它已经在用户文件夹和注册表里创建了一些数据
  - 如果要进行覆盖安装操作，那么需要逐个检查之前残留的软件，下载，安装
  - 但等等，如何确保软件的安装路径和原先的一致？万一软件会在你指定的路径下建一个子文件夹，恭喜你，你有了两个同款软件
  - 新版本的软件不需要旧版本的文件，还不如删掉重装
  - 删掉重装不如把软件放在 C 盘，随系统的重装而重装
  - 如果 C 盘不够大，那可以考虑分大一点

- 把你的可复用数据，比如绿色软件、游戏、虚拟机、应用缓存、网上可以下载到的资源等，放在一个单独、较大的分区，比如 D 盘，这样可以节省你的C盘的空间并提高你的数据的安全性。因为：
  - 绿色软件不需要安装，所以重装系统以后也不需要安装。
  - 虚拟机文件夹占用空间较大，但重装系统后可以直接导入，恢复原样。
  - Steam 游戏库文件夹占用空间较大，但重装系统后可以直接导入，恢复原样。

- 把个人文件（独一无二的重要文件），比如文档、图片、音乐、视频等，放在一个单独的分区，比如E盘，这样可以方便备份。如果你是“**单分区原教旨主义者**”，你也要三思而后行。因为：
  - 你应该听说过[某款安装在根目录的程序在卸载时会删除整个分区的文件](https://zhuanlan.zhihu.com/p/659087695)吧
  - 操作系统重装时总需要一部分的空间做备份，一个分区重装时全删了，备份时要再建一个分区，不还是两个分区吗？
  - 你也不想操作系统、程序文件和你的个人文件、学习资料混在一起吧
::

如果“软件装 D 盘”真的是个好主意，为什么大多数软件还会默认指定 C 盘的安装路径呢？这就不得不提到下一个话题了。

## C 盘的文件夹与扩容

> 阅读下面这篇文章，或许可以得知这些问题的答案：
>
> - 为什么我的 C 盘不知不觉就红了？C 盘要多大才合适？
> - 分区快满了（「红了」）怎么办？
> - 我怎么把我的某个分区扩大/缩小一点？
> - 有没有什么办法把 C 盘一些占空间又不能动的东西移到别处去？

::link-card
---
icon: https://www.criwits.top/missing/favicon.png
title: 成为空间管理大师 - 你缺失的那门计算机课
link: https://www.criwits.top/missing/manage-storage.html
---
::

文章中也讲述了 C 盘中各文件夹的作用。例如 QQ、微信会将用户数据存在“文档”文件夹中，这是符合 Windows 规范的做法，但一些用户会选择将体积较大“文档”文件夹移动到 D 盘，反而违背了 Windows 多用户的文件夹整洁性。

放心把软件放在默认位置吧，不用费尽心思打理它们，毕竟有时候会弄巧成拙，适得其反。

如果 C 盘空间已满，可以使用 DiskGenius 之类的软件**扩容 C 盘，而不是大动干戈**地将 C 盘的文件移动到其他分区。相关操作方法请自行搜索。

## WizTree 与垃圾清理

WizTree 是一款可视化的硬盘空间分析工具。用它可以快速查看占用空间最大的文件夹，从而找出可以删除的东西。

以下这些文件请放心删除：

- 安装包
  - 动辄 10G+ 安装包，尤其是各种创意设计、工程制图、仿真模拟软件
  - 某某应用商店的软件下载文件夹，使用这类应用商店类应用在安装软件后通常不会自动删除安装包
- QQ / 微信旧文件
  - 从传统 QQ 升级到 QQ NT 之后，`文档\Tencent Files\[QQ号]` 下除了 `nt_` 开头的文件夹之外都是旧版 QQ 的账号数据，可以删除
  - 微信会自动接收文件，可以在 `文档\WeChat Files\[原始wxid]\FileStorage\File` 下检查删除不需要的文件
  - QQ、微信在设置中有空间管理功能，可以清理空间
- VS Code 的 C/C++ 编译缓存
  - 位于 `%LocalAppData%\Microsoft\vscode-cpptools\ipch\`
- 浏览器缓存
  - `下载` 文件夹中可能会有不少失去作用的文件
  - `%LocalAppData%\[浏览器开发商]\[浏览器名]\User Data\Default\Service Worker` 下的 `CacheStorage` 文件夹可能会有大量无用缓存，例如一些网盘没有使用浏览器的下载 API，而是在网页内显示进度条，这种情况下文件很可能会遗留在 SW 缓存中

以下这些文件需要格外注意：

- MSI 安装包
  - 位于 `C:\Windows\Installer` 文件夹下
  - 删除后，许多软件无法正常升级/卸载
- 系统备份
  - 位于 `System Volume Information` 文件夹下
  - 可以在 `Windows 设置-系统-系统信息-系统保护-配置…` 中管理占用大小
- 休眠文件
  - 位于 `C:\hiberfil.sys`
  - 用于休眠（不是睡眠）或者笔记本在电量不足时保存状态，下一次开机时自动恢复电脑当前状态
  - 如果要关闭，需要使用管理员权限打开 `cmd`，输入 `powercfg -h off`{lang="sh"}，随后休眠文件会自动删除
- 虚拟内存
  - 位于 `C:\pagefile.sys`
  - 建议由系统自动管理

## “无为而治”或许是个好选择

但电脑终归是自己的，用起来**怎么顺手怎么来**吧。

再次推荐《你缺失的那门计算机课》，由浅入深，无论你是电脑小白还是系统高手，都可以收获颇丰。

::link-card
---
icon: https://www.criwits.top/missing/favicon.png
title: 你缺失的那门计算机课
link: https://www.criwits.top/missing/
---
::
